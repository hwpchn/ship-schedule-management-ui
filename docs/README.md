# èˆ¹èˆ¶æ—¶åˆ»è¡¨ç³»ç»Ÿ API æ–‡æ¡£

æœ¬æ–‡æ¡£æä¾›äº†èˆ¹èˆ¶æ—¶åˆ»è¡¨ç³»ç»Ÿæ‰€æœ‰APIæ¥å£çš„è¯¦ç»†è¯´æ˜å’Œä½¿ç”¨æŒ‡å—ã€‚

## ğŸ“‹ ç›®å½•ç»“æ„

```
api/
â”œâ”€â”€ README.md                           # æœ¬æ–‡æ¡£
â”œâ”€â”€ ğŸ¥ ç³»ç»Ÿæ¥å£
â”‚   â””â”€â”€ health-check.md                # å¥åº·æ£€æŸ¥API
â”œâ”€â”€ ğŸ” è®¤è¯æ¨¡å— (Authentication)
â”‚   â”œâ”€â”€ auth-overview.md               # è®¤è¯æ¨¡å—æ¦‚è§ˆ
â”‚   â”œâ”€â”€ user-registration.md           # ç”¨æˆ·æ³¨å†ŒAPI
â”‚   â”œâ”€â”€ user-login.md                  # ç”¨æˆ·ç™»å½•API
â”‚   â””â”€â”€ permissions.md                 # æƒé™ç®¡ç†API
â””â”€â”€ ğŸš¢ èˆ¹èˆ¶è°ƒåº¦æ¨¡å— (Schedules)
    â”œâ”€â”€ vessel-schedules.md            # èˆ¹èˆ¶æ—¶åˆ»è¡¨API
    â”œâ”€â”€ vessel-info.md                 # èˆ¹èˆ¶é¢å¤–ä¿¡æ¯API
    â”œâ”€â”€ cabin-grouping.md              # å…±èˆ±åˆ†ç»„API
    â”œâ”€â”€ cabin-config.md                # å…±èˆ±é…ç½®API
    â”œâ”€â”€ bulk-operations.md             # æ‰¹é‡æ“ä½œAPI
    â””â”€â”€ ui-edit-design.md              # å‰ç«¯ç¼–è¾‘åŠŸèƒ½è®¾è®¡æ–¹æ¡ˆ
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### åŸºç¡€ä¿¡æ¯
- **API Base URL**: `http://127.0.0.1:8000/api`
- **APIç‰ˆæœ¬**: v1.0.0
- **è®¤è¯æ–¹å¼**: JWT Bearer Token
- **æ•°æ®æ ¼å¼**: JSON
- **å­—ç¬¦ç¼–ç **: UTF-8

### é€šç”¨å“åº”æ ¼å¼
```json
{
  "success": true,
  "message": "æ“ä½œæˆåŠŸ",
  "data": {},
  "error": null
}
```

### é”™è¯¯å“åº”æ ¼å¼
```json
{
  "success": false,
  "message": "é”™è¯¯æè¿°",
  "data": null,
  "error": {
    "code": "ERROR_CODE",
    "details": {}
  }
}
```

## ğŸ”‘ è®¤è¯æµç¨‹

1. **ç”¨æˆ·æ³¨å†Œ**: `POST /api/auth/register/`
2. **ç”¨æˆ·ç™»å½•**: `POST /api/auth/login/` (è·å–access_token)
3. **APIè°ƒç”¨**: åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `Authorization: Bearer <access_token>`
4. **Tokenåˆ·æ–°**: `POST /api/auth/token/refresh/`

## ğŸ“š APIåˆ†ç±»

### ğŸ¥ ç³»ç»Ÿæ¥å£
| æ¥å£ | æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|------|
| å¥åº·æ£€æŸ¥ | GET | `/api/` | æ£€æŸ¥APIæœåŠ¡çŠ¶æ€ |

### ğŸ” è®¤è¯æ¨¡å— (Authentication)
| åŠŸèƒ½åˆ†ç±» | æ¥å£æ•°é‡ | è¯´æ˜ |
|----------|----------|------|
| ç”¨æˆ·ç®¡ç† | 3ä¸ª | æ³¨å†Œã€ç™»å½•ã€Tokenåˆ·æ–° |
| æƒé™ç®¡ç† | 1ä¸ª | æƒé™æŸ¥è¯¢ |

### ğŸš¢ èˆ¹èˆ¶è°ƒåº¦æ¨¡å— (Schedules)
| åŠŸèƒ½åˆ†ç±» | æ¥å£æ•°é‡ | è¯´æ˜ |
|----------|----------|------|
| èˆ¹èˆ¶æ—¶åˆ»è¡¨ | 4ä¸ª | CRUDæ“ä½œã€æœç´¢ç»Ÿè®¡ |
| èˆ¹èˆ¶é¢å¤–ä¿¡æ¯ | 6ä¸ª | CRUDæ“ä½œã€æ‰¹é‡æ“ä½œ |
| å…±èˆ±åŠŸèƒ½ | 8ä¸ª | åˆ†ç»„æŸ¥è¯¢ã€é…ç½®ç®¡ç† |

## ğŸ›¡ï¸ æƒé™ç³»ç»Ÿ

### æƒé™åˆ†ç±»
- **èˆ¹èˆ¶è°ƒåº¦ç®¡ç†** (`vessel_schedule.*`)
- **èˆ¹èˆ¶ä¿¡æ¯ç®¡ç†** (`vessel_info.*`)

### æƒé™æ£€æŸ¥
å¤§éƒ¨åˆ†APIéœ€è¦ç›¸åº”çš„æƒé™æ‰èƒ½è®¿é—®ï¼Œè¯¦ç»†æƒé™è¦æ±‚è¯·æŸ¥çœ‹å„APIæ–‡æ¡£ã€‚

## ğŸ“– ä½¿ç”¨ç¤ºä¾‹

### 1. å¥åº·æ£€æŸ¥
```bash
curl -X GET "http://127.0.0.1:8000/api/"
```

### 2. ç”¨æˆ·æ³¨å†Œ
```bash
curl -X POST "http://127.0.0.1:8000/api/auth/register/" \
  -H "Content-Type: application/json" \
  -d '{
    "email": "user@example.com",
    "password": "securepassword123",
    "password_confirm": "securepassword123",
    "first_name": "å¼ ",
    "last_name": "ä¸‰"
  }'
```

### 3. ç”¨æˆ·ç™»å½•
```bash
curl -X POST "http://127.0.0.1:8000/api/auth/login/" \
  -H "Content-Type: application/json" \
  -d '{
    "email": "user@example.com",
    "password": "securepassword123"
  }'
```

### 4. å¸¦è®¤è¯çš„APIè°ƒç”¨
```bash
curl -X GET "http://127.0.0.1:8000/api/schedules/" \
  -H "Authorization: Bearer <your_access_token>"
```

## ğŸ”§ æµ‹è¯•å·¥å…·

### è¿è¡ŒAPIæµ‹è¯•
```bash
# è¿›å…¥æµ‹è¯•ç›®å½•
cd tests/

# è¿è¡ŒAPIç»¼åˆæµ‹è¯•
python tests/api_full_test.py

# æˆ–ä½¿ç”¨æµ‹è¯•è„šæœ¬
./run_api_test.sh

# è¿è¡Œç‰¹å®šAPIæµ‹è¯•
python tests/test_cabin_grouping_api.py
python tests/test_cabin_config_api.py
python tests/test_vessel_info_bulk_operations.py
```

### Postmané›†åˆ
æ¨èä½¿ç”¨Postmanè¿›è¡ŒAPIæµ‹è¯•ï¼Œå¯ä»¥å¯¼å…¥ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š
- `base_url`: `http://127.0.0.1:8000/api`
- `access_token`: `<your_access_token>`

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **æ—¶é—´æ ¼å¼**: æ‰€æœ‰æ—¶é—´å­—æ®µä½¿ç”¨ISO 8601æ ¼å¼ (`YYYY-MM-DDTHH:MM:SS+08:00`)
2. **åˆ†é¡µ**: åˆ—è¡¨æ¥å£æ”¯æŒåˆ†é¡µï¼Œä½¿ç”¨`page`å’Œ`page_size`å‚æ•°
3. **è¿‡æ»¤**: æ”¯æŒå¤šç§è¿‡æ»¤å‚æ•°ï¼Œè¯¦è§å„APIæ–‡æ¡£
4. **æ’åº**: ä½¿ç”¨`ordering`å‚æ•°è¿›è¡Œæ’åº
5. **ä¸­æ–‡æ”¯æŒ**: æ‰€æœ‰æ¥å£å®Œå…¨æ”¯æŒä¸­æ–‡å­—ç¬¦
6. **é”™è¯¯å¤„ç†**: è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯å’ŒçŠ¶æ€ç 

## ğŸš¨ é”™è¯¯ç å‚è€ƒ

| HTTPçŠ¶æ€ç  | è¯´æ˜ |
|------------|------|
| 200 | è¯·æ±‚æˆåŠŸ |
| 201 | åˆ›å»ºæˆåŠŸ |
| 400 | è¯·æ±‚å‚æ•°é”™è¯¯ |
| 401 | æœªè®¤è¯æˆ–Tokenæ— æ•ˆ |
| 403 | æƒé™ä¸è¶³ |
| 404 | èµ„æºä¸å­˜åœ¨ |
| 500 | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ |

## ğŸ“ æ”¯æŒè”ç³»

å¦‚æœ‰APIä½¿ç”¨é—®é¢˜ï¼Œè¯·ï¼š
1. æŸ¥çœ‹ç›¸å…³APIæ–‡æ¡£
2. è¿è¡Œå¯¹åº”çš„æµ‹è¯•æ–‡ä»¶
3. æ£€æŸ¥é”™è¯¯æ—¥å¿—
4. è”ç³»å¼€å‘å›¢é˜Ÿ

---

**æœ€åæ›´æ–°**: 2025å¹´5æœˆ25æ—¥  
**APIç‰ˆæœ¬**: v1.0.0  
**ç»´æŠ¤å›¢é˜Ÿ**: èˆ¹èˆ¶æ—¶åˆ»è¡¨é¡¹ç›®ç»„
